<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æˆäººADHDç—‡çŠ¶ç­›æŸ¥é‡è¡¨ï¼ˆASRS v1.1ï¼‰</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
    <style>
        /* æ ¸å¿ƒæ ·å¼ï¼ˆä¿ç•™ï¼‰ */
        body {
            font-family: "Microsoft YaHei", "PingFang SC", sans-serif;
            background: linear-gradient(120deg, #fdf2f8 0%, #e8f4f8 100%);
            color: #4a5568;
            min-height: 100vh;
            padding: 1rem 0;
        }
        .container {
            max-width: 800px;
            margin: 1rem auto;
            background: rgba(255, 255, 255, 0.95);
            padding: 2rem;
            border-radius: 20px;
            box-shadow: 0 8px 32px rgba(149, 157, 165, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.8);
        }
        .page {
            display: none;
        }
        .page.active {
            display: block;
            animation: fadeIn 0.8s ease;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(15px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .question {
            margin-bottom: 1.8rem;
            padding: 1.5rem;
            border-radius: 15px;
            background: linear-gradient(135deg, #faf0f5 0%, #f0f8fb 100%);
            border: 1px solid rgba(240, 248, 255, 0.6);
            transition: all 0.3s ease;
        }
        .question:hover {
            box-shadow: 0 4px 12px rgba(224, 231, 255, 0.4);
        }
        .unanswered {
            border-left: 4px solid #ed8936;
        }
        .option {
            margin: 0.8rem 0;
            padding: 0.3rem 0;
            cursor: pointer;
        }
        input[type="radio"] {
            margin-right: 0.8rem;
            accent-color: #9f7aea;
        }
        .btn {
            border-radius: 50px;
            padding: 0.8rem 1.5rem;
            border: none;
            transition: all 0.3s ease;
            font-weight: 500;
        }
        .btn-primary {
            background: linear-gradient(135deg, #9f7aea 0%, #667eea 100%);
            box-shadow: 0 4px 12px rgba(159, 122, 234, 0.3);
        }
        .btn-primary:hover {
            background: linear-gradient(135deg, #805ad5 0%, #5a67d8 100%);
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(159, 122, 234, 0.4);
        }
        .btn-outline-secondary {
            background: rgba(255, 255, 255, 0.8);
            color: #718096;
            border: 1px solid #e2e8f0;
        }
        .btn-outline-secondary:hover {
            background: #f7fafc;
            color: #4a5568;
            border: 1px solid #cbd5e0;
        }
        .btn-outline-primary {
            background: rgba(255, 255, 255, 0.8);
            color: #9f7aea;
            border: 1px solid #e9d8fd;
        }
        .btn-outline-primary:hover {
            background: #fdf2f8;
            color: #805ad5;
            border: 1px solid #d6bcfa;
        }
        .btn-group {
            margin-top: 2.5rem;
            display: flex;
            justify-content: space-between;
            gap: 1rem;
        }
        .result-card {
            background: linear-gradient(135deg, #fef7fb 0%, #f5fafe 100%);
            padding: 2rem;
            border-radius: 18px;
            margin: 2rem 0;
            border: 1px solid rgba(240, 248, 255, 0.8);
            box-shadow: 0 4px 16px rgba(224, 231, 255, 0.2);
        }
        .risk-high {
            color: #e53e3e;
            font-weight: 600;
        }
        .risk-normal {
            color: #38a169;
            font-weight: 600;
        }
        .card {
            border-radius: 18px;
            border: none;
            background: linear-gradient(135deg, #faf0f5 0%, #f0f8fb 100%);
            box-shadow: 0 4px 16px rgba(224, 231, 255, 0.2);
        }
        .marketing-module {
            margin: 1.5rem 0;
            padding: 1.5rem;
            border-radius: 15px;
            background: linear-gradient(135deg, #fcf1f7 0%, #eaf6fa 100%);
            border: 1px solid rgba(240, 248, 255, 0.7);
        }
        .text-primary-emphasis {
            color: #805ad5 !important;
            font-weight: 600;
        }
        /* å¼¹çª—æ ·å¼ä¼˜åŒ– */
        .detail-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 9999;
            display: none;
            padding: 1rem;
        }
        .modal-content {
            background: white;
            padding: 2rem;
            border-radius: 18px;
            max-width: 500px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
        }
        .close-modal {
            float: right;
            border: none;
            background: none;
            font-size: 1.2rem;
            cursor: pointer;
            color: #718096;
        }
        .disclaimer {
            font-size: 0.95rem;
            color: #718096;
            margin-top: 2.5rem;
            padding-top: 1.5rem;
            border-top: 1px dashed #e2e8f0;
            line-height: 1.8;
        }
        h2 {
            color: #2d3748;
            font-weight: 600;
            margin-bottom: 1.8rem;
            position: relative;
            padding-bottom: 0.8rem;
        }
        h2::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 80px;
            height: 3px;
            background: linear-gradient(90deg, #9f7aea 0%, #667eea 100%);
            border-radius: 3px;
        }
        h5 {
            color: #2d3748;
            font-weight: 600;
            margin-bottom: 1rem;
        }
        h6 {
            color: #2d3748;
            font-weight: 600;
        }
        .text-muted {
            color: #718096 !important;
            line-height: 1.6;
        }
        .modal-body p {
            margin-bottom: 0.8rem;
            line-height: 1.5;
            font-size: 0.95rem;
        }
        /* æ–°å¢ï¼šå°çº¢ä¹¦æ ‡é¢˜æ æ ·å¼ */
        .xiaohongshu-header {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.8rem;
            margin-bottom: 1.5rem;
            padding: 1rem;
            background: linear-gradient(135deg, #fdf2f8 0%, #fef7fb 100%);
            border-radius: 15px;
            border: 1px solid rgba(240, 248, 255, 0.6);
        }
        .xiaohongshu-icon {
            width: 36px;
            height: 36px;
            object-fit: cover;
            border-radius: 8px; /* è½»å¾®åœ†è§’é€‚é…å°çº¢ä¹¦logoé£æ ¼ */
        }
        .xiaohongshu-text {
            font-size: 1.2rem;
            font-weight: 600;
            color: #805ad5;
            letter-spacing: 0.5px;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- ç¬¬1é¡µï¼šå£°æ˜åŒæ„é¡µï¼ˆæ–°å¢å°çº¢ä¹¦æ ‡é¢˜æ ï¼‰ -->
        <div id="page1" class="page active">
            <!-- æ–°å¢ï¼šå°çº¢ä¹¦å›¾æ ‡+æ–‡å­—åŒºåŸŸï¼ˆæ›¿æ¢ä¸ºæŒ‡å®šlogoï¼‰ -->
            <div class="xiaohongshu-header">
                <img src="https://p3-flow-imagex-sign.byteimg.com/tos-cn-i-a9rns2rl98/18d3b8fd8cde4972b4d13803a3353071.png~tplv-a9rns2rl98-image.png?rcl=2026010318585421F417F6ACDB46ABA258&rk3s=8e244e95&rrcfp=dafada99&x-expires=2083661935&x-signature=2DnjwyXSI2bFVsc7EXvwMqhhfK0%3D" class="xiaohongshu-icon">
                <span class="xiaohongshu-text">å°æ˜Ÿçš„è¶£å‘³å¿ƒæµ‹</span>
            </div>
            
            <h2 class="text-center mb-5">æˆäººADHDç—‡çŠ¶ç­›æŸ¥é‡è¡¨ï¼ˆASRS v1.1ï¼‰</h2>
            <div class="card mb-5">
                <div class="card-body p-4">
                    <h5 class="card-title mb-3">ä½¿ç”¨å£°æ˜</h5>
                    <p class="card-text mb-2">1. æœ¬é‡è¡¨åŸºäºä¸–ç•Œå«ç”Ÿç»„ç»‡ï¼ˆWHOï¼‰å‘å¸ƒçš„ASRS v1.1æ ‡å‡†å¼€å‘ï¼Œä»…ç”¨äºæˆäººADHDç—‡çŠ¶çš„åˆæ­¥ç­›æŸ¥ï¼Œ<strong>ä¸æ„æˆåŒ»ç–—è¯Šæ–­æˆ–æ²»ç–—å»ºè®®</strong>ã€‚</p>
                    <p class="card-text mb-2">2. ç­”é¢˜æ•°æ®ä¸ºæ•æ„Ÿä¿¡æ¯ï¼Œä»…æœ¬åœ°å­˜å‚¨ï¼Œä¸ä¼šä¸Šä¼ è‡³ç¬¬ä¸‰æ–¹æœåŠ¡å™¨ï¼Œæ‚¨å¯éšæ—¶åˆ é™¤ã€‚</p>
                    <p class="card-text mb-2">3. ç­›æŸ¥ç»“æœé«˜é£é™©è€…å»ºè®®å‰å¾€æ­£è§„åŒ»ç–—æœºæ„ç²¾ç¥ç§‘ã€å¿ƒç†ç§‘å°±è¯Šï¼Œç”±ä¸“ä¸šäººå‘˜è¯„ä¼°ç¡®è¯Šã€‚</p>
                    <p class="card-text">4. æœ¬é‡è¡¨ä»…é€‚ç”¨äº18å‘¨å²åŠä»¥ä¸Šæˆå¹´äººï¼Œæœªæˆå¹´äººéœ€ç›‘æŠ¤äººé™ªåŒä½¿ç”¨ã€‚</p>
                </div>
            </div>
            <div class="marketing-module mb-5">
                <h6 class="text-primary-emphasis mb-2">ğŸ’¡ æ–°ç”¨æˆ·ä¸“å±ç¦åˆ©</h6>
                <p class="text-muted mb-3">æ·»åŠ å¾®ä¿¡ã€XXX123456ã€‘ï¼Œæµ‹è¯•åå¯é¢†å–1æ¬¡å…è´¹çš„ç—‡çŠ¶æ–‡å­—è§£è¯»ï¼ˆé™å‰100åï¼‰</p>
                <div class="d-flex justify-content-center">
                    <img src="https://p3-flow-imagex-sign.byteimg.com/tos-cn-i-a9rns2rl98/3ceb451627c743e2b82c1389374701ee.jpg~tplv-a9rns2rl98-image.png?rcl=20260103182954434D35C7C347015B11E5&rk3s=8e244e95&rrcfp=dafada99&x-expires=2083660194&x-signature=a34h5kHSjDpWlJ8Rs%2Flt%2B1B9mW0%3D" 
             alt="å¾®ä¿¡äºŒç»´ç " 
             class="rounded" 
             style="width:150px;height:150px;">
                </div>
            </div>
            <div class="form-check mb-5">
                <input class="form-check-input" type="checkbox" id="agree">
                <label class="form-check-label fs-6" for="agree">
                    æˆ‘å·²é˜…è¯»ã€åŒæ„ä¸Šè¿°å£°æ˜ï¼Œè‡ªæ„¿è¿›è¡Œæœ¬æ¬¡ç­›æŸ¥
                </label>
            </div>
            <button id="toPage2" class="btn btn-primary btn-lg w-100" disabled>å¼€å§‹è‡ªæµ‹ï¼Œ3åˆ†é’Ÿç†æ¸…æ³¨æ„åŠ›é—®é¢˜</button>
        </div>

        <!-- ç¬¬2é¡µï¼šç­”é¢˜é¡µ -->
        <div id="page2" class="page">
            <h2 class="text-center mb-5">ç­”é¢˜é¡µï¼ˆå…±3é¡µï¼Œå½“å‰ç¬¬<span id="currentPage">1</span>/3é¡µï¼‰</h2>
            <p class="text-muted text-center mb-4">è¯·æ ¹æ®è¿‡å»6ä¸ªæœˆçš„æ„Ÿå—å’Œè¡Œä¸ºï¼Œä¸ºæ¯é¢˜é€‰æ‹©åˆé€‚çš„é¢‘ç‡ï¼š0=ä»ä¸ï¼Œ1=å¾ˆå°‘ï¼Œ2=æœ‰æ—¶ï¼Œ3=ç»å¸¸</p>
            <div id="questionsContainer"></div>
            <div class="btn-group">
                <button id="prevPage" class="btn btn-outline-secondary" disabled>ä¸Šä¸€é¢˜</button>
                <button id="nextPage" class="btn btn-primary">ä¸‹ä¸€é¢˜</button>
            </div>
        </div>

        <!-- ç¬¬3é¡µï¼šç»“æœé¡µï¼ˆå·²åˆ é™¤æŒ‡å®šæ¨¡å—ï¼‰ -->
        <div id="page3" class="page">
            <h2 class="text-center mb-5">ç­›æŸ¥ç»“æœæŠ¥å‘Š</h2>
            <div class="result-card mb-4">
                <h5>ä¸€ã€æˆ‘çš„æµ‹è¯•è®°å½•</h5>
                <div id="testRecord">
                    <p class="text-muted">æš‚æ— å†å²æµ‹è¯•è®°å½•</p>
                </div>
            </div>
            <div class="result-card">
                <h5>äºŒã€é£é™©ç­‰çº§è¯„ä¼°</h5>
                <p class="mb-2">æ‚¨çš„æ ¸å¿ƒé¢˜ï¼ˆAéƒ¨åˆ†6é¢˜ï¼‰é«˜é£é™©é¡¹ï¼š<span id="coreScore">0</span>/6</p>
                <p class="mb-2">é£é™©ç­‰çº§ï¼š<span id="riskLevel" class="risk-normal">ä¸€èˆ¬æç¤º</span></p>
                <p>è§£è¯»ï¼š<span id="riskDesc">æ‚¨çš„ç—‡çŠ¶ä¸ADHDç›¸å…³æ€§è¾ƒä½ï¼Œä½†ä»å¯ç»“åˆè‡ªèº«æ„Ÿå—å’¨è¯¢ä¸“ä¸šäººå£«ã€‚</span></p>
            </div>
            <div class="result-card">
                <h5>ä¸‰ã€è¯¦ç»†å¾—åˆ†</h5>
                <p class="mb-1">æ ¸å¿ƒç­›æŸ¥é¢˜ï¼ˆAéƒ¨åˆ†6é¢˜ï¼‰æ€»åˆ†ï¼š<span id="aScore">0</span>/18</p>
                <p class="mb-1">è¡¥å……è¯„ä¼°é¢˜ï¼ˆBéƒ¨åˆ†12é¢˜ï¼‰æ€»åˆ†ï¼š<span id="bScore">0</span>/36</p>
                <p>18é¢˜æ€»å¾—åˆ†ï¼š<span id="totalScore">0</span>/54</p>
            </div>
            <div class="result-card">
                <h5>å››ã€å»ºè®®ä¸æç¤º</h5>
                <ul style="line-height: 1.8; padding-left: 1.5rem;">
                    <li>æœ¬ç»“æœä»…ä¸ºåˆæ­¥ç­›æŸ¥ï¼Œä¸èƒ½æ›¿ä»£ä¸“ä¸šè¯Šæ–­ï¼Œç¡®è¯Šéœ€ç»ç²¾ç¥ç§‘åŒ»ç”ŸæŒ‰DSM-5/ICD-11æ ‡å‡†è¯„ä¼°ã€‚</li>
                    <li>è‹¥æ‚¨åœ¨å·¥ä½œæˆ–å­¦ä¹ ä¸­å­˜åœ¨æ³¨æ„åŠ›æˆ–å†²åŠ¨æ§åˆ¶ç­‰é—®é¢˜å¹¶å½±å“ç”Ÿæ´»ï¼Œå»ºè®®åŠæ—¶å°±åŒ»ã€‚</li>
                    <li>æ­£è§„å°±åŒ»æ¸ é“ï¼šå½“åœ°ä¸‰ç”²åŒ»é™¢ç²¾ç¥ç§‘æˆ–å¿ƒç†ç§‘ï¼›ä¸“ä¸šå¿ƒç†å¥åº·æœåŠ¡æœºæ„ï¼›å«å¥å§”è®¤è¯çš„å¿ƒç†æ´åŠ©çƒ­çº¿ã€‚</li>
                </ul>
            </div>
            <button id="restartTest" class="btn btn-outline-primary w-100">é‡æ–°è‡ªæµ‹ï¼Œè·Ÿè¸ªç—‡çŠ¶å˜åŒ–</button>
            <div class="disclaimer">
                <p>å…è´£å£°æ˜ï¼šæœ¬æŠ¥å‘Šä»…ä¸ºç­›æŸ¥å‚è€ƒï¼Œä¸æ„æˆåŒ»ç–—è¯Šæ–­æˆ–æ²»ç–—å»ºè®®ã€‚å› ä½¿ç”¨æœ¬æŠ¥å‘Šäº§ç”Ÿçš„ä»»ä½•å†³ç­–åŠåæœï¼Œç”±ç”¨æˆ·è‡ªè¡Œæ‰¿æ‹…ã€‚</p>
            </div>
        </div>
    </div>

    <!-- æµ‹è¯•è®°å½•è¯¦æƒ…å¼¹çª— -->
    <div class="detail-modal" id="detailModal">
        <div class="modal-content">
            <button class="close-modal" id="closeModal">Ã—</button>
            <h5 class="mb-3">æµ‹è¯•è¯¦æƒ…</h5>
            <div id="modalBody"></div>
        </div>
    </div>

    <script>
        // é‡è¡¨é¢˜ç›®æ•°æ®ï¼ˆ18é¢˜å®Œæ•´ï¼‰
        const questions = [
            { id: 1, type: 'A', content: 'å®Œæˆé¡¹ç›®å…·æœ‰æŒ‘æˆ˜æ€§çš„éƒ¨åˆ†åï¼Œå¾ˆéš¾æ”¶å°¾ç»†èŠ‚å·¥ä½œã€‚' },
            { id: 2, type: 'A', content: 'é¢å¯¹éœ€è¦è§„åˆ’çš„ä»»åŠ¡æ—¶ï¼Œéš¾ä»¥åšåˆ°äº•ç„¶æœ‰åºã€‚' },
            { id: 3, type: 'A', content: 'ç»å¸¸å¿˜è®°çº¦ä¼šæˆ–é‡è¦äº‹é¡¹æˆ–éœ€è¦åŠç†çš„äº‹åŠ¡ã€‚' },
            { id: 4, type: 'A', content: 'å›é¿æˆ–æ‹–å»¶éœ€è¦é•¿æ—¶é—´ä¸“æ³¨æ€è€ƒçš„å¤æ‚ä»»åŠ¡ã€‚' },
            { id: 5, type: 'A', content: 'éš¾ä»¥é•¿æ—¶é—´ä¿æŒåå§¿ï¼Œæ€»æƒ³èµ·èº«æ´»åŠ¨æˆ–æ‰¾äº‹æƒ…åšã€‚' },
            { id: 6, type: 'A', content: 'æ„Ÿè§‰ä½“å†…åƒæœ‰â€œé©¬è¾¾â€é©±åŠ¨ï¼Œæ— æ³•å®‰é™å¾…ç€ã€‚' },
            { id: 7, type: 'B', content: 'å¤„ç†å•è°ƒæˆ–é‡å¤çš„å·¥ä½œæ—¶ï¼Œå®¹æ˜“ç²—å¿ƒçŠ¯é”™ã€‚' },
            { id: 8, type: 'B', content: 'åˆ«äººè¯´è¯æ—¶ï¼Œå¾ˆéš¾ä»å¤´åˆ°å°¾ä¸“å¿ƒå¬å®Œï¼ˆå®¹æ˜“èµ°ç¥ï¼‰ã€‚' },
            { id: 9, type: 'B', content: 'åœ¨å®¶æˆ–å·¥ä½œåœºæ‰€ï¼Œå®¹æ˜“è¢«å‘¨å›´çš„æ´»åŠ¨æˆ–å£°éŸ³åˆ†æ•£æ³¨æ„åŠ›ã€‚' },
            { id: 10, type: 'B', content: 'å¾ˆéš¾æŒ‰è®¡åˆ’æ‰§è¡Œä»»åŠ¡ï¼Œå¸¸åç¦»æ—¢å®šå®‰æ’ã€‚' },
            { id: 11, type: 'B', content: 'ç»å¸¸åŒæ—¶å¼€å±•å¤šä¸ªé¡¹ç›®ï¼Œéš¾ä»¥é¡ºåˆ©å®Œæˆå…¶ä¸­ä»»ä½•ä¸€ä¸ªã€‚' },
            { id: 12, type: 'B', content: 'åœ¨ä¼šè®®æˆ–éœ€è¦é™åçš„åœºåˆï¼Œä¼šå¿ä¸ä½ç¦»å¼€åº§ä½ã€‚' },
            { id: 13, type: 'B', content: 'å³ä½¿åœ¨ä¸éœ€è¦å¿«é€Ÿè¡ŒåŠ¨çš„åœºæ™¯ä¸‹ï¼Œä¹Ÿä¼šè¡¨ç°å¾—æ€¥èºåŒ†å¿™ã€‚' },
            { id: 14, type: 'B', content: 'ç‹¬å¤„æ—¶éš¾ä»¥è®©è‡ªå·±æ”¾æ¾ï¼Œæ€»è§‰å¾—éœ€è¦ä¿æŒå¿™ç¢Œã€‚' },
            { id: 15, type: 'B', content: 'ç¤¾äº¤ä¸­ä¼šåœ¨åˆ«äººè¿˜æ²¡è¯´å®Œè¯æ—¶å°±æ’å˜´æˆ–æŠ¢ç­”ã€‚' },
            { id: 16, type: 'B', content: 'ç»å¸¸æ„Ÿåˆ°ç²¾åŠ›ä¸é›†ä¸­ï¼Œå½±å“å·¥ä½œä¸æ—¥å¸¸äº‹åŠ¡æ•ˆç‡ã€‚' },
            { id: 17, type: 'B', content: 'æ’é˜Ÿç­‰å¾…æ—¶ï¼Œå¾ˆéš¾ä¿æŒè€å¿ƒã€‚' },
            { id: 18, type: 'B', content: 'åˆ«äººå¿™ç¢Œæ—¶ï¼Œä¼šå¿ä¸ä½æ‰“æ–­æˆ–æ‰“æ‰°å¯¹æ–¹ã€‚' }
        ];

        // å…¨å±€å˜é‡
        let currentPage = 1;
        let answers = new Array(18).fill(null);
        let testRecords = JSON.parse(localStorage.getItem('adhdTestRecords')) || [];

        // DOMå…ƒç´ ï¼ˆå·²ç§»é™¤ä»˜è´¹æœåŠ¡ã€å¤åˆ¶æ–‡æ¡ˆç›¸å…³å…ƒç´ ï¼‰
        const page1 = document.getElementById('page1');
        const page2 = document.getElementById('page2');
        const page3 = document.getElementById('page3');
        const agreeCheckbox = document.getElementById('agree');
        const toPage2Btn = document.getElementById('toPage2');
        const prevPageBtn = document.getElementById('prevPage');
        const nextPageBtn = document.getElementById('nextPage');
        const currentPageText = document.getElementById('currentPage');
        const questionsContainer = document.getElementById('questionsContainer');
        const coreScoreText = document.getElementById('coreScore');
        const riskLevelText = document.getElementById('riskLevel');
        const riskDescText = document.getElementById('riskDesc');
        const aScoreText = document.getElementById('aScore');
        const bScoreText = document.getElementById('bScore');
        const totalScoreText = document.getElementById('totalScore');
        const restartTestBtn = document.getElementById('restartTest');
        const testRecordEl = document.getElementById('testRecord');
        const detailModal = document.getElementById('detailModal');
        const closeModalBtn = document.getElementById('closeModal');
        const modalBody = document.getElementById('modalBody');

        // é¡µé¢åŠ è½½å®Œæˆåæ‰§è¡Œ
        document.addEventListener('DOMContentLoaded', function() {
            console.log('é¡µé¢DOMåŠ è½½å®Œæˆï¼Œå¼€å§‹åˆå§‹åŒ–'); // è°ƒè¯•æ—¥å¿—
            
            // æ¢å¤ç­”é¢˜è¿›åº¦
            const savedAnswers = localStorage.getItem('adhdTestAnswers');
            if (savedAnswers) {
                answers = JSON.parse(savedAnswers);
                if (!answers.includes(null)) {
                    currentPage = 3;
                    page1.classList.remove('active');
                    page2.classList.add('active');
                    renderQuestions();
                    calculateResult();
                    page2.classList.remove('active');
                    page3.classList.add('active');
                }
            }

            // æ¸²æŸ“æµ‹è¯•è®°å½•
            renderTestRecords();

            // å¼¹çª—å…³é—­äº‹ä»¶
            closeModalBtn.addEventListener('click', () => {
                detailModal.style.display = 'none';
            });
            detailModal.addEventListener('click', (e) => {
                if (e.target === detailModal) detailModal.style.display = 'none';
            });

            // åŒæ„å¤é€‰æ¡†äº‹ä»¶
            agreeCheckbox.addEventListener('change', function() {
                console.log('å¤é€‰æ¡†çŠ¶æ€ï¼š', this.checked); // è°ƒè¯•æ—¥å¿—
                toPage2Btn.disabled = !this.checked;
                // å¼ºåˆ¶åˆ·æ–°æŒ‰é’®çŠ¶æ€ï¼ˆå…¼å®¹éƒ¨åˆ†æµè§ˆå™¨è§†è§‰å»¶è¿Ÿï¼‰
                if (this.checked) {
                    toPage2Btn.removeAttribute('disabled');
                } else {
                    toPage2Btn.setAttribute('disabled', 'disabled');
                }
            });

            // å¼€å§‹è‡ªæµ‹æŒ‰é’®ç‚¹å‡»äº‹ä»¶
            toPage2Btn.addEventListener('click', function() {
                console.log('ç‚¹å‡»äº†å¼€å§‹è‡ªæµ‹æŒ‰é’®'); // è°ƒè¯•æ—¥å¿—
                page1.classList.remove('active');
                page2.classList.add('active');
                renderQuestions();
            });

            // é‡æ–°è‡ªæµ‹æŒ‰é’®äº‹ä»¶
            restartTestBtn.addEventListener('click', function() {
                answers = new Array(18).fill(null);
                currentPage = 1;
                localStorage.removeItem('adhdTestAnswers');
                page3.classList.remove('active');
                page1.classList.add('active');
                agreeCheckbox.checked = false;
                toPage2Btn.disabled = true;
            });

            // æ¸²æŸ“ç­”é¢˜é¡µé¢˜ç›®
            function renderQuestions() {
                const startIndex = (currentPage - 1) * 6;
                const endIndex = startIndex + 6;
                const currentQuestions = questions.slice(startIndex, endIndex);
                
                questionsContainer.innerHTML = '';
                currentQuestions.forEach((q, index) => {
                    const questionIndex = startIndex + index;
                    const isAnswered = answers[questionIndex] !== null;
                    const questionHtml = `
                        <div class="question ${!isAnswered ? 'unanswered' : ''}">
                            <h6 class="mb-3">${q.id}. ${q.content}</h6>
                            <div class="option">
                                <input type="radio" name="q${questionIndex}" id="q${questionIndex}_0" value="0" ${answers[questionIndex] === '0' ? 'checked' : ''}>
                                <label for="q${questionIndex}_0">0=ä»ä¸</label>
                            </div>
                            <div class="option">
                                <input type="radio" name="q${questionIndex}_1" value="1" ${answers[questionIndex] === '1' ? 'checked' : ''}>
                                <label for="q${questionIndex}_1">1=å¾ˆå°‘</label>
                            </div>
                            <div class="option">
                                <input type="radio" name="q${questionIndex}_2" value="2" ${answers[questionIndex] === '2' ? 'checked' : ''}>
                                <label for="q${questionIndex}_2">2=æœ‰æ—¶</label>
                            </div>
                            <div class="option">
                                <input type="radio" name="q${questionIndex}_3" value="3" ${answers[questionIndex] === '3' ? 'checked' : ''}>
                                <label for="q${questionIndex}_3">3=ç»å¸¸</label>
                            </div>
                        </div>
                    `;
                    questionsContainer.innerHTML += questionHtml;
                });
                currentPageText.textContent = currentPage;
                prevPageBtn.disabled = currentPage === 1;
                nextPageBtn.textContent = currentPage === 3 ? 'æäº¤ç­”æ¡ˆï¼Œè·å–ä¸“å±é£é™©åˆ†æ' : 'ä¸‹ä¸€é¢˜';
            }

            // ç›‘å¬ç­”é¢˜é€‰æ‹©
            questionsContainer.addEventListener('change', (e) => {
                if (e.target.type === 'radio') {
                    const questionIndex = parseInt(e.target.name.replace('q', ''));
                    answers[questionIndex] = e.target.value;
                    localStorage.setItem('adhdTestAnswers', JSON.stringify(answers));
                    e.target.closest('.question').classList.remove('unanswered');
                }
            });

            // ä¸Šä¸€é¢˜
            prevPageBtn.addEventListener('click', () => {
                if (currentPage > 1) {
                    currentPage--;
                    renderQuestions();
                }
            });

            // ä¸‹ä¸€é¢˜/æäº¤
            nextPageBtn.addEventListener('click', () => {
                const startIndex = (currentPage - 1) * 6;
                const endIndex = startIndex + 6;
                let unansweredCount = 0;
                for (let i = startIndex; i < endIndex; i++) {
                    if (answers[i] === null) unansweredCount++;
                }
                if (unansweredCount > 0) {
                    alert(`å½“å‰é¡µè¿˜æœ‰ ${unansweredCount} é“é¢˜æœªä½œç­”ï¼Œè¯·å®Œæˆåå†ç»§ç»­ï¼`);
                    return;
                }
                if (currentPage < 3) {
                    currentPage++;
                    renderQuestions();
                } else {
                    calculateResult();
                    page2.classList.remove('active');
                    page3.classList.add('active');
                }
            });

            // è®¡ç®—ç»“æœ
            function calculateResult() {
                let aScore = 0, bScore = 0;
                answers.slice(0, 6).forEach(score => aScore += parseInt(score));
                answers.slice(6, 18).forEach(score => bScore += parseInt(score));
                const totalScore = aScore + bScore;
                const highRiskCount = answers.slice(0, 6).filter(score => parseInt(score) >= 2).length;
                
                let riskLevel = 'ä¸€èˆ¬æç¤º', riskDesc = 'æ‚¨çš„ç—‡çŠ¶ä¸ADHDç›¸å…³æ€§è¾ƒä½ï¼Œä½†ä»å¯ç»“åˆè‡ªèº«æ„Ÿå—å’¨è¯¢ä¸“ä¸šäººå£«ã€‚', riskClass = 'risk-normal';
                if (highRiskCount >= 4) {
                    riskLevel = 'é«˜é£é™©æç¤º';
                    riskDesc = 'æ‚¨å­˜åœ¨ADHDç›¸å…³ç—‡çŠ¶çš„å¯èƒ½æ€§è¾ƒé«˜ï¼Œå»ºè®®å°½å¿«å‰å¾€æ­£è§„åŒ»ç–—æœºæ„çš„ç²¾ç¥ç§‘ã€å¿ƒç†ç§‘å°±è¯Šï¼Œç”±ä¸“ä¸šäººå‘˜è¿›è¡Œä¸´åºŠè¯„ä¼°ã€‚';
                    riskClass = 'risk-high';
                }

                // æ›´æ–°ç»“æœé¡µ
                coreScoreText.textContent = highRiskCount;
                riskLevelText.textContent = riskLevel;
                riskLevelText.className = riskClass;
                riskDescText.textContent = riskDesc;
                aScoreText.textContent = aScore;
                bScoreText.textContent = bScore;
                totalScoreText.textContent = totalScore;

                // ä¿å­˜æµ‹è¯•è®°å½•
                const newRecord = {
                    date: new Date().toLocaleDateString(),
                    riskLevel: riskLevel,
                    totalScore: totalScore,
                    aScore: aScore,
                    bScore: bScore,
                    answers: [...answers]
                };
                testRecords.push(newRecord);
                localStorage.setItem('adhdTestRecords', JSON.stringify(testRecords));
                renderTestRecords();
            }

            // æ¸²æŸ“æµ‹è¯•è®°å½•
            function renderTestRecords() {
                if (testRecords.length > 0) {
                    let recordHtml = '<ul style="line-height: 1.8; padding-left: 1.5rem;">';
                    testRecords.forEach((record, index) => {
                        recordHtml += `
                            <li>
                                ${index+1}. ${record.date} - é£é™©ç­‰çº§ï¼š${record.riskLevel} - æ€»åˆ†ï¼š${record.totalScore}
                                <button class="btn btn-sm btn-outline-primary ms-2" onclick="showRecordDetail(${index})">æŸ¥çœ‹è¯¦æƒ…</button>
                            </li>
                        `;
                    });
                    recordHtml += '</ul>';
                    testRecordEl.innerHTML = recordHtml;
                } else {
                    testRecordEl.innerHTML = '<p class="text-muted">æš‚æ— å†å²æµ‹è¯•è®°å½•</p>';
                }
            }

            // æ˜¾ç¤ºæµ‹è¯•è¯¦æƒ…
            window.showRecordDetail = function(index) {
                const record = testRecords[index];
                const coreHighRisk = record.answers.slice(0,6).filter(s => parseInt(s)>=2).length;
                let detailHtml = `
                    <p><strong>æµ‹è¯•æ—¥æœŸï¼š</strong>${record.date}</p>
                    <p><strong>é£é™©ç­‰çº§ï¼š</strong>${record.riskLevel}</p>
                    <p><strong>æ ¸å¿ƒé¢˜é«˜é£é™©é¡¹ï¼š</strong>${coreHighRisk}/6</p>
                    <p><strong>å¾—åˆ†è¯¦æƒ…ï¼š</strong>æ ¸å¿ƒé¢˜${record.aScore}/18ï¼Œè¡¥å……é¢˜${record.bScore}/36ï¼Œæ€»åˆ†${record.totalScore}/54</p>
                    <h6 class="mt-3 mb-2">ç­”é¢˜è®°å½•ï¼ˆå…±18é¢˜ï¼‰ï¼š</h6>
                `;
                record.answers.forEach((score, idx) => {
                    const scoreText = ['ä»ä¸', 'å¾ˆå°‘', 'æœ‰æ—¶', 'ç»å¸¸'][parseInt(score)];
                    detailHtml += `<p>${questions[idx].id}. ${questions[idx].content} â†’ ${scoreText}</p>`;
                });
                modalBody.innerHTML = detailHtml;
                detailModal.style.display = 'flex';
            }

        });
    </script>
</body>
</html>